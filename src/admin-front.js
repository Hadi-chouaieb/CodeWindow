function ajouterPage(){let e=document.getElementById("pageUrl").value;let t=document.getElementById("pageTitle").value;const n=new XMLHttpRequest;n.open("POST","http://localhost:3000/admin/addlink",true);n.setRequestHeader("Content-Type","application/json");n.onreadystatechange=function(){if(n.readyState===4){if(n.status===200){const e=n.responseText;openPopup("./src/assets/imgs/tick.png",e,"Succès");showLink();document.getElementById("pageTitle").value="";document.getElementById("pageUrl").value=""}else{console.error("Error:",n.status,n.statusText)}}};if(e==""||t==""){openPopup("./src/assets/imgs/err.png","veuillez remplir les champs","Erreur")}else{const s={url:e,titel:t,valid:"Y"};const o=JSON.stringify(s);n.send(o)}}function showLink(){const n=new XMLHttpRequest;n.open("GET","http://localhost:3000/admin/showLink",true);n.setRequestHeader("Content-Type","application/json");n.onreadystatechange=function(){if(n.readyState===4){if(n.status===200){const t=JSON.parse(n.responseText);var e=document.getElementById("container");e.replaceChildren("");for(i=0;i<t.length;i++){addpage(t[i].id,t[i].url,t[i].title,t[i].valid)}}else{console.error("Error:",n.status,n.statusText)}}};const e={};const t=JSON.stringify(e);n.send(t)}if(document.title="Code Window Gestion"){showLink()}function UpdateHideLinks(e){const t=new XMLHttpRequest;t.open("POST","http://localhost:3000/admin/updateHide",true);t.setRequestHeader("Content-Type","application/json");t.onreadystatechange=function(){if(t.readyState===4){if(t.status===200){const e=t.responseText}else{console.error("Error:",t.status,t.statusText)}}};const n={id:e};const s=JSON.stringify(n);t.send(s)}function UpdateShowLinks(e){const t=new XMLHttpRequest;t.open("POST","http://localhost:3000/admin/updateShow",true);t.setRequestHeader("Content-Type","application/json");t.onreadystatechange=function(){if(t.readyState===4){if(t.status===200){const e=t.responseText}else{console.error("Error:",t.status,t.statusText)}}};const n={id:e};const s=JSON.stringify(n);t.send(s)}function deleteLink(e){const t=new XMLHttpRequest;t.open("POST","http://localhost:3000/admin/deleteLink",true);t.setRequestHeader("Content-Type","application/json");t.onreadystatechange=function(){if(t.readyState===4){if(t.status===200){const e=t.responseText;showLink()}else{console.error("Error:",t.status,t.statusText)}}};const n={id:e};const s=JSON.stringify(n);t.send(s)}showCLNotPayed();function showCLNotPayed(){const t=new XMLHttpRequest;t.open("GET","http://localhost:3000/admin/showCLNotPayed",true);t.setRequestHeader("Content-Type","application/json");t.onreadystatechange=function(){if(t.readyState===4){if(t.status===200){const e=JSON.parse(t.responseText);document.getElementById("clnb").innerText=e.clnbr;document.getElementById("ttprix").innerText=e.totalprix/1e3+"DT"}else{console.error("Error:",t.status,t.statusText)}}};const e={};const n=JSON.stringify(e);t.send(n)}let popup=document.getElementById("popup");function openPopup(e,t,n){document.getElementById("hedmsg").innerText=n;document.getElementById("img").src=e;document.getElementById("msgg").innerText=t;popup.classList.add("open-popup")}function closePopup(){popup.classList.remove("open-popup")}function activation(){let t=document.getElementById("activate").value;const n=new XMLHttpRequest;n.open("GET","http://localhost:3000/service/A1_1A",true);n.setRequestHeader("Content-Type","application/json");n.onreadystatechange=function(){if(n.readyState===4){if(n.status===200){const e=JSON.parse(n.responseText);if(activateKeys(e[0].Key,t)){activ(t)}else{openPopup("./src/assets/imgs/err.png","le clé non correct","Erreur")}}else{console.error("Error:",n.status,n.statusText)}}};const e={};const s=JSON.stringify(e);n.send(s)}function showKey(){const t=new XMLHttpRequest;t.open("GET","http://localhost:3000/service/A1_1A",true);t.setRequestHeader("Content-Type","application/json");t.onreadystatechange=function(){if(t.readyState===4){if(t.status===200){const e=JSON.parse(t.responseText);document.getElementById("keyText").innerText=e[0].Key;document.getElementById("keyDat").innerText=e[0].mtyfn}}};const e={};const n=JSON.stringify(e);t.send(n)}showKey();function activ(e){const t=new XMLHttpRequest;t.open("POST","http://localhost:3000/service/1AA",true);t.setRequestHeader("Content-Type","application/json");t.onreadystatechange=function(){if(t.readyState===4){if(t.status===200){const e=t.responseText;window.location.replace("index.html")}else{console.error("Error:",t.status,t.statusText)}}};const n={key:e,num:1};const s=JSON.stringify(n);t.send(s)}function changepassword(){const e=document.getElementById("newpswd").value;const t=new XMLHttpRequest;t.open("POST","http://localhost:3000/admin/updatepass",true);t.setRequestHeader("Content-Type","application/json");t.onreadystatechange=function(){if(t.readyState===4){if(t.status===200){const e=t.responseText;openPopup("./src/assets/imgs/tick.png","Le mot de passe a été modifié avec succès ","Succès");document.getElementById("newpswd").value=""}}};if(e.length<4){openPopup("./src/assets/imgs/err.png","le mot de passe doit contenir au moins 4 caractères","Erreur")}else{const n={pass:e};const s=JSON.stringify(n);t.send(s)}}function changenom(){const e=document.getElementById("newuser").value;const t=new XMLHttpRequest;t.open("POST","http://localhost:3000/admin/updateusername",true);t.setRequestHeader("Content-Type","application/json");t.onreadystatechange=function(){if(t.readyState===4){if(t.status===200){const e=t.responseText;openPopup("./src/assets/imgs/tick.png","Le nom de l'utilisateur a été modifié avec succès","Succès");document.getElementById("newuser").value=""}}};if(e.length<4){openPopup("./src/assets/imgs/err.png","le nom doit contenir au moins 4 caractères","Erreur")}else{const n={nam:e};const s=JSON.stringify(n);t.send(s)}}function changephoto(){const e=new FormData;e.append("photo",document.getElementById("newphoto").files[0]);const t=new XMLHttpRequest;t.open("POST","http://localhost:3000/admin/updatephoto",true);t.onreadystatechange=function(){if(t.readyState===4){if(t.status===200){const e=t.responseText;openPopup("./src/assets/imgs/tick.png","L'image a été mise à jour avec succès","Succès");window.location.reload()}}};t.send(e)}function userdata(){const t=new XMLHttpRequest;t.open("GET","http://localhost:3000/admin/status",true);t.setRequestHeader("Content-Type","application/json");t.onreadystatechange=function(){if(t.readyState===4){if(t.status===200){const e=JSON.parse(t.responseText);document.getElementById("logo").src=e[0].image;document.getElementById("logo").classList.add("imroud")}}};const e={};const n=JSON.stringify(e);t.send(n)}userdata();function logout(){const t=new XMLHttpRequest;t.open("POST","http://localhost:3000/admin/logout",true);t.setRequestHeader("Content-Type","application/json");t.onreadystatechange=function(){if(t.readyState===4){if(t.status===200){const e=t.responseText;window.location.replace("login.html")}}};t.send()}