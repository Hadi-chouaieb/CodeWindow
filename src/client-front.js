const{response}=require("express");let popup=document.getElementById("popup");function openPopup(e,t,n){document.getElementById("hedmsg").innerText=n;document.getElementById("img").src=e;document.getElementById("msgg").innerText=t;popup.classList.add("open-popup")}function closePopup(){popup.classList.remove("open-popup")}function addcl(){var e=document.getElementById("nome").value;const t=new XMLHttpRequest;t.onreadystatechange=function(){if(t.readyState===4){if(t.status===200){openPopup("./src/assets/imgs/tick.png","Client ajouter","Succès");document.getElementById("nome").value="";showCL()}else{console.error("Error:",t.status)}}};t.open("POST","http://localhost:3000/client/addCL",true);t.setRequestHeader("Content-Type","application/json");const n={nom:e};const s=JSON.stringify(n);if(e!=""){t.send(s)}else{openPopup("./src/assets/imgs/err.png","Veuillez entrer le nom du client","Erreur")}}function showCL(){let e=document.getElementById("nomShow").value;const n=new XMLHttpRequest;n.open("POST","http://localhost:3000/client/showCL",true);n.setRequestHeader("Content-Type","application/json");n.onreadystatechange=function(){if(n.readyState===4){if(n.status===200){const e=JSON.parse(n.responseText);var t=document.getElementById("clients");t.replaceChildren("");for(i=0;i<e.length;i++){addOptionSelect(e[i].id,e[i].nom,t)}}else{console.error("Error:",n.status,n.statusText)}}};const t={nom:e};const s=JSON.stringify(t);n.send(s)}if(document.title=="Code Window service"){showCL()}function addOptionSelect(e,t,n){var s=document.createElement("option");s.value=e;s.textContent=t;n.appendChild(s)}function addOptionToTable(e,t){var n=document.createElement("tr");var s=document.createElement("td");s.textContent=e;n.appendChild(s);t.appendChild(n)}function showPrix(){let e=document.getElementById("clients").value;localStorage.clear();const s=new XMLHttpRequest;s.open("POST","http://localhost:3000/client/clachat",true);s.setRequestHeader("Content-Type","application/json");s.onreadystatechange=function(){if(s.readyState===4){if(s.status===200){const e=JSON.parse(s.responseText);var n=document.getElementById("userprix");n.replaceChildren("");if(e.length!=0){document.getElementById("clnm").innerText="Facture de "+e[0].nom}else{document.getElementById("clnm").innerText="Cette personne n'a rien acheté"}let t=0;for(i=0;i<e.length;i++){addOptionToTable(e[i].prix,n);t+=parseInt(e[i].prix)}localStorage.setItem("prix",t);addOptionToTable(t,n)}else{console.error("Error:",s.status,s.statusText)}}};const t={id:e};const n=JSON.stringify(t);s.send(n)}function addprix(){let e=document.getElementById("clients").value;let t=document.getElementById("addprix").value;console.log(e,t);if(t!=""&&e!=""){const n=new XMLHttpRequest;n.open("POST","http://localhost:3000/client/addprix",true);n.setRequestHeader("Content-Type","application/json");n.onreadystatechange=function(){if(n.readyState===4){if(n.status===200){const e=JSON.parse(n.responseText);console.log(e);openPopup("./src/assets/imgs/tick.png",e,"Succès");document.getElementById("addprix").value=""}else{console.error("Error:",n.status,n.statusText)}}};const s={id:e,prix:t};const o=JSON.stringify(s);n.send(o)}else{openPopup("./src/assets/imgs/err.png","Metter La valeur des achats et choisir un client","Erreur")}}function payment(){let id=document.getElementById("clients").value;a=localStorage.getItem("prix");pp=document.getElementById("payment").value;prix=eval(a-pp);const xhr=new XMLHttpRequest;xhr.open("POST","http://localhost:3000/client/payment",true);xhr.setRequestHeader("Content-Type","application/json");xhr.onreadystatechange=function(){if(xhr.readyState===4){if(xhr.status===200){openPopup("./src/assets/imgs/tick.png",xhr.response,"Succès");document.getElementById("payment").value="";showCL()}else{console.error("Error:",xhr.status)}}};const requestBody={prix:prix,id:id};const jsonRequest=JSON.stringify(requestBody);if(pp!=""){xhr.send(jsonRequest)}else{openPopup("./src/assets/imgs/err.png","Veuillez entrer le payment","Erreur")}}function suppcl(){let e=document.getElementById("clients").value;const t=new XMLHttpRequest;t.open("POST","http://localhost:3000/client/suppcl",true);t.setRequestHeader("Content-Type","application/json");t.onreadystatechange=function(){if(t.readyState===4){if(t.status===200){const e=JSON.parse(t.responseText);openPopup("./src/assets/imgs/tick.png",e,"Succès");showCL()}else{console.error("Error:",t.status,t.statusText)}}};const n={id:e};const s=JSON.stringify(n);t.send(s)}function showLink(){const t=new XMLHttpRequest;t.open("GET","http://localhost:3000/admin/showLink_valid",true);t.setRequestHeader("Content-Type","application/json");t.onreadystatechange=function(){if(t.readyState===4){if(t.status===200){const e=JSON.parse(t.responseText);for(i=0;i<e.length;i++){addlinktolist(e[i].url,e[i].title)}}else{console.error("Error:",t.status,t.statusText)}}};const e={};const n=JSON.stringify(e);t.send(n)}if(document.title=="Code Window service"){showLink()}function addlinktolist(e,t){if(e.substr(e.length-4,e.length)!=".com"){e=e+".com/"}else{e=e}if(e.substr(0,7)!="http://"){e="http://"+e}else{e=e}var n=document.createElement("li");n.className=e;n.id="linkstolist";n.style.cursor="pointer";n.title=e;var s=document.createElement("span");s.innerText=t;s.className="linn text-warning fw-bold";s.title=e;s.id="linkstolist";n.appendChild(s);var o=document.getElementById("menulist");o.appendChild(n)}function showKey(){const t=new XMLHttpRequest;t.open("GET","http://localhost:3000/service/A1_1A",true);t.setRequestHeader("Content-Type","application/json");t.onreadystatechange=function(){if(t.readyState===4){if(t.status===200){const e=JSON.parse(t.responseText);document.getElementById("keyText").innerText=e[0].Key;document.getElementById("keyDat").innerText=e[0].mtyfn}}};const e={};const n=JSON.stringify(e);t.send(n)}function automo(){const t=new XMLHttpRequest;t.open("GET","http://localhost:3000/service/A1A",true);t.setRequestHeader("Content-Type","application/json");t.onreadystatechange=function(){if(t.readyState===4){if(t.status===200){const e=t.responseText;if(e=="false"){window.location.replace("gestiion.html")}}}};const e={};const n=JSON.stringify(e);t.send(n)}automo();function adminstatus(){const t=new XMLHttpRequest;t.open("GET","http://localhost:3000/admin/status",true);t.setRequestHeader("Content-Type","application/json");t.onreadystatechange=function(){if(t.readyState===4){if(t.status===200){const e=JSON.parse(t.responseText);if(e[0].status=="N"){window.location.replace("login.html")}else{if(document.title!="Code Window service"){window.location.replace("index.html")}}}}};const e={};const n=JSON.stringify(e);t.send(n)}adminstatus();function userdata(){const t=new XMLHttpRequest;t.open("GET","http://localhost:3000/admin/status",true);t.setRequestHeader("Content-Type","application/json");t.onreadystatechange=function(){if(t.readyState===4){if(t.status===200){const e=JSON.parse(t.responseText);document.getElementById("logo").src=e[0].image;document.getElementById("logo").classList.add("imroud")}}};const e={};const n=JSON.stringify(e);t.send(n)}userdata();function logout(){const t=new XMLHttpRequest;t.open("POST","http://localhost:3000/admin/logout",true);t.setRequestHeader("Content-Type","application/json");t.onreadystatechange=function(){if(t.readyState===4){if(t.status===200){const e=t.responseText;window.location.replace("login.html")}}};t.send()}